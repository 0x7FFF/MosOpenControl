# Документация
# Экран аутентификации
## Тестовые данные
###Экран авторизации
* +79111111111 - fail интернет соединения
* +79111111112 - fail бэка
* любой другой номер success

###Экран ввода кода
* 11111 - fail интернет соединения
* 22222 - неправильный код
* любой другой код success
## AuthScreen

Этот файл определяет экран аутентификации приложения.
## Функция AuthScreen

Это функция Composable, которая устанавливает экран для аутентификации пользователя.

### Параметры:
```
    viewModel: Экземпляр AuthViewModel. Эта ViewModel отвечает за подготовку и управление данными, необходимыми для AuthScreen.
    navController: NavController используется для навигации по различным Composables в приложении.
```
Функция наблюдает за состоянием navigateTo модели ViewModel. Всякий раз, когда новое место назначения выталкивается в navigateTo, функция переходит к этому месту назначения, если жизненный цикл находится хотя бы в состоянии STARTED.

Она также следит за состоянием ViewModel и передает его в AuthContent Composable.
## Функция AuthContent

Это функция Composable, которая обеспечивает макет экрана аутентификации.

### Параметры:
```
    state: Экземпляр AuthState, который представляет текущее состояние процесса аутентификации.
    обратный вызов: Это экземпляр интерфейса AuthUiCallback, который будет вызван при взаимодействии пользователя с пользовательским интерфейсом.
```
Эта функция устанавливает Scaffold, который включает текстовое поле для ввода пользователем номера телефона и кнопку для отправки номера телефона.
# AuthScreenViewModel.kt

Этот файл определяет ViewModel для экрана аутентификации.
## Класс AuthViewModel

Модель ViewModel отвечает за подготовку и управление данными для экрана AuthScreen. Она расширяет ViewModel() и реализует AuthUiCallback.

### Параметры:
```
    authUseCase: Случай использования, определяющий логику аутентификации.
    resourceManager: Используется для работы с ресурсами.
```
Модель ViewModel имеет две основные обязанности:
```
    Она управляет экземпляром AuthState, который представляет текущее состояние процесса аутентификации. Состояние отображается как StateFlow, который может наблюдаться Composables.
    Он управляет состоянием navigateTo, которое можно наблюдать для перехода к различным составным элементам.
```
ViewModel также определяет функцию reduce, которая изменяет состояние на основе действий.
Интерфейс AuthUiCallback

Этот интерфейс используется для обработки взаимодействий пользовательского интерфейса.

### Функции:
```
    onAuthClick(phoneNumber: String): Эта функция вызывается, когда пользователь нажимает на кнопку аутентификации.
    onReqClick(): Эта функция вызывается, когда пользователь что-то запрашивает. Она еще не реализована.
```
## Запечатанный интерфейс Action

Этот герметичный интерфейс представляет все возможные действия, которые могут происходить на экране аутентификации.

### Подтипы:
```
    Auth: Представляет действие аутентификации.
    Error (ошибка): Представляет действие, когда произошла ошибка.
    SuccessAuth: Представляет действие при успешной аутентификации.
```
## Класс данных AuthState

Этот класс данных представляет текущее состояние процесса аутентификации.

### Поля:
```
    phoneNumber: Номер телефона, который ввел пользователь.
    inProgress (в процессе): Булево значение, указывающее, идет ли процесс аутентификации.
    error (ошибка): Строка, представляющая любое сообщение об ошибке, которое должно быть показано пользователю.
```

# Главный экран
# MainScreen

Этот файл определяет главный экран приложения.
## Функция MainScreen

Это функция Composable, которая устанавливает главный экран приложения.

### Параметры:
```
    user: Экземпляр MOSUser, представляющий пользователя.
    listItems: Это список MainListItem, представляющий список элементов, которые будут отображаться на главном экране.
```
Функция формирует колонку, содержащую Заголовок и список ListItemContent. Заголовок отображает информацию о пользователе, а ListItemContent - список элементов. Функция также обрабатывает действия для каждого элемента в списке.
## Функция Header

Это функция Composable, которая устанавливает заголовок главного экрана.

### Параметры:
```
    user: Экземпляр MOSUser, представляющий пользователя.
```
Функция создает Строку, содержащую две текстовые композиции для отображения приветствия и имени пользователя, и Блок для отображения аватара пользователя.
## Функция ListItemContent

Это составная функция, которая устанавливает список элементов на главном экране.

### Параметры:
```
    listItems: Это список MainListItem, представляющий список элементов, которые будут отображаться на главном экране.
    onListItemAction: Это лямбда-функция для обработки действия при нажатии на элемент списка.
```
Функция формирует LazyColumn, содержащий ListItemCard Composables для каждого элемента в списке ListItems.
## Функция ListItemCard

Это составная функция, которая устанавливает карточку элемента списка на главном экране.

### Параметры:
```
    listItem: экземпляр MainListItem, представляющий элемент списка.
    onListItemAction: Это лямбда-функция для обработки действия при нажатии на карточку элемента списка.
```
Функция создает карточку, содержащую строку с текстовыми компонентами для отображения заголовка и текста элемента списка, и изображение для отображения изображения элемента списка. Карточка является кликабельной, а действие клика обрабатывается функцией onListItemAction.
### Классы данных
```
    MOSUser: Представляет пользователя в приложении. Поля могут включать имя, фамилию и идентификатор ресурса аватара пользователя.
    MainListItem: Представляет элемент в списке главного экрана. Поля могут включать заголовок элемента, текст, идентификатор ресурса изображения и связанное с ним действие.
    MainListItemAction: Представляет действие, связанное с элементом MainListItem. Может быть перечислением или закрытым классом с подтипами для различных действий, таких как переход к чат-боту или инициация консультации.
```

# Экран чата
## ChatScreen
Эта функция представляет собой @Composable функцию, которая представляет главный экран чата.
### Параметры
```
    viewModel: ChatViewModel: ViewModel, связанная с этим экраном. Эта ViewModel содержит состояние и бизнес-логику, связанную с сообщениями чата.
    onBack: () -> Unit: Это лямбда-функция, которая вызывается при нажатии кнопки "Назад".
```
### Описание

Функция состоит из Box, который содержит Column. Колонка используется для вертикального расположения различных компонентов экрана чата.

В верхней части находится ChatHeader, который содержит кнопку "Назад". При нажатии этой кнопки вызывается лямбда-функция onBack.

Ниже ChatHeader находится Spacer, который обеспечивает некоторое расстояние между заголовком и остальным содержимым.

Далее находится оператор if, который проверяет, есть ли сообщения. Если сообщений нет, отображается карточка InitialMessageCard вместе с кнопкой для начала чата. Если сообщения есть, отображается MessageList, за которым следует BottomBar.

В MessageList отображаются все сообщения в чате.

Нижняя панель содержит текстовое поле для ввода новых сообщений, кнопку для прикрепления файлов и кнопку для отправки голосовых сообщений. Поведение этих кнопок определяется методами в ViewModel.
### Композитная функция MessageList

Эта функция является @Composable функцией, которая представляет список сообщений чата.
### Параметры
```
    модификатор: Модификатор: Это модификатор, который может быть использован для настройки внешнего вида и поведения этого компонуемого списка.
    сообщения: List<ChatMessage>: Это список сообщений чата, которые будут отображаться в списке.
```
### Описание

Функция использует LazyColumn для отображения списка сообщений чата. Для каждого сообщения в списке она вызывает функцию TextMessage.
### Функция TextMessage Composable

Эта функция представляет собой @Composable функцию, которая представляет одно сообщение чата.
### Параметры
```
    сообщение: ChatMessage: Это сообщение чата, которое должно быть отображено.
```
### Описание

Функция использует Box для размещения текста сообщения. Выравнивание сообщения определяется тем, является ли сообщение от пользователя или нет. Если сообщение от пользователя, то выравнивание будет Alignment.CenterEnd. Если сообщение не от пользователя, то выравнивание будет Alignment.CenterStart.

Цвет пузырька сообщения и цвет текста также определяются тем, пришло сообщение от пользователя или нет.
Возвращаемое значение

Эта функция не возвращает никакого значения.
Композитная функция BottomBar

Эта функция представляет собой @Composable функцию, которая представляет нижнюю панель экрана чата.
### Параметры
```
    messageText: Строка: Текст сообщения, которое должно быть отправлено.
    onMessageTextChanged: (String) -> Unit: Это лямбда-функция, которая вызывается при изменении текста сообщения.
    onSendMessage: (String) -> Unit: Это лямбда-функция, которая вызывается при отправке сообщения.
    onAttachFile: () -> Unit: Это лямбда-функция, которая вызывается при нажатии кнопки прикрепления файла.
    onStartVoiceMessage: () -> Единица: Это лямбда-функция, которая вызывается при нажатии кнопки голосового сообщения.
```
### Описание

Функция использует Row для горизонтального расположения кнопки прикрепления файла, текстового поля для ввода сообщения и кнопки отправки или голосового сообщения.

Текстовое поле связано с параметром messageText. Когда текст в поле изменяется, вызывается лямбда-функция onMessageTextChanged с новым текстом.

Кнопка отправки связана с лямбда-функцией onSendMessage. Когда кнопка нажата, вызывается эта функция с текстом сообщения.

Кнопка прикрепления файла связана с лямбда-функцией onAttachFile. При нажатии кнопки вызывается эта функция.

Кнопка голосового сообщения связана с лямбда-функцией onStartVoiceMessage. Когда кнопка нажата, вызывается эта функция.

## ChatViewModel

Этот класс представляет ViewModel для экрана чата. Он содержит состояние и бизнес-логику для сообщений чата.
### Свойства
```
    messages: Это список объектов ChatMessage с изменяемым состоянием (mutableStateOf). Он представляет текущее состояние сообщений чата.
```
### Функции
```
    onSendMessage(message: String): Эта функция вызывается при отправке нового сообщения. Она добавляет сообщение в список сообщений.
    onReceiveMessage(message: String): Эта функция вызывается при получении нового сообщения. Она добавляет сообщение в список сообщений.
    onAttachFile(): Эта функция вызывается при нажатии кнопки прикрепления файла. Она добавляет сообщение-заполнитель в список сообщений.
    onStartVoiceMessage(): Эта функция вызывается при нажатии кнопки голосового сообщения. Она добавляет сообщение-заполнитель в список сообщений.
```
### Примечания

В реальном приложении функция onReceiveMessage, скорее всего, будет подключена к внутренней службе, которая получает сообщения от других пользователей. Аналогично, функции onAttachFile и onStartVoiceMessage, скорее всего, открывают диалог выбора файла и запускают запись голосового сообщения соответственно. Эти функции не реализованы в данном коде.
## Класс данных ChatMessage

Этот класс данных представляет сообщение чата.
### Свойства
```
    text: Строка: Текст сообщения.
    timeStamp: Строка: Временная метка сообщения в формате "HH:MM".
    isFromUser: Булево: Булево значение, указывающее, является ли сообщение сообщением от пользователя или нет.
    isReceived (получено): Булево: Булево значение, указывающее, было ли сообщение получено или нет.
```
### Примечания

В реальном приложении свойство isReceived, вероятно, будет использоваться для отображения индикатора "сообщение получено" в пользовательском интерфейсе. В данном коде эта функция не реализована.
